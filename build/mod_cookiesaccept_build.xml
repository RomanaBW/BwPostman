<?xml version="1.0" encoding="UTF-8"?>

<project name="ModCookiesAccept"  description="Build file for corrected module mod_cookiesaccept" default="pack">

	<!-- ============================================  -->
	<!-- Target: prepare                               -->
	<!-- (Setting variables, delete target directory,  -->
	<!--  create target directory)                     -->
	<!-- ============================================  -->
	<target name="prepare">
		<echo msg="Set variables…" />
		<echo msg="Generals…" />
		<property name="extension" value="ModCookiesAccept" override="true" />
		<property name="module" value="mod_cookiesaccept" override="true" />

		<echo msg="Source dirs…" />
		<property name="source_base_dir" value="/vhosts/dev" override="true" />

		<property name="source_site_dir" value="${source_base_dir}/modules/${module}" override="true" />
		<property name="source_site_lang_dir" value="${source_base_dir}/language" override="true" />

		<property name="source_module_dir" value="${source_base_dir}/modules/mod_cookiesaccept" override="true" />

		<echo msg="target dirs…" />
		<property name="target_base_dir" value="/Support/Software/Joomla/Cookies/${extension}/${version}" override="true" />
		<property name="target_base_module_dir" value="${target_base_dir}/${module}" override="true" />

		<echo msg="Deleting target directories… " />
		<delete dir="/Support/Software/Joomla/Cookies/${extension}/${version}" includeemptydirs="true" verbose="true" failonerror="false" />

		<echo msg="Creating target directories… " />
		<mkdir dir="${target_base_module_dir}/files/site/language/de-DE" />
		<mkdir dir="${target_base_module_dir}/files/site/language/en-GB" />
		<mkdir dir="${target_base_module_dir}/files/site/language/fr-FR" />
		<mkdir dir="${target_base_module_dir}/files/site/language/it-IT" />
		<mkdir dir="${target_base_module_dir}/files/site/language/es-ES" />
		<mkdir dir="${target_base_module_dir}/files/site/language/pl-PL" />
	</target>

	<!-- ============================================  -->
	<!-- Target: build                                 -->
	<!-- (copy files of component and modules to       -->
	<!-- target directory, empty capimgdir, move       -->
	<!-- manifest file, copy install file to base dir) -->
	<!-- ============================================  -->
	<target name="build" depends="prepare">
		<echo msg="Copying files to build directory…" />

		<echo msg="Copying module …" />
		<copy todir="${target_base_module_dir}/files/site">
			<fileset dir="${source_module_dir}">
				<include name="**" />
			</fileset>
		</copy>
		<copy todir="${target_base_module_dir}/files/site/language/de-DE">
			<fileset dir="${source_site_lang_dir}/de-DE">
				<include name="**/*${module}*.ini" />
			</fileset>
		</copy>
		<copy todir="${target_base_module_dir}/files/site/language/en-GB">
			<fileset dir="${source_site_lang_dir}/en-GB">
				<include name="**/*${module}*.ini" />
			</fileset>
		</copy>

		<copy todir="${target_base_module_dir}/files/site/language/fr-FR">
			<fileset dir="${source_site_lang_dir}/fr-FR">
				<include name="**/*${module}*.ini" />
			</fileset>
		</copy>

		<copy todir="${target_base_module_dir}/files/site/language/it-IT">
			<fileset dir="${source_site_lang_dir}/it-IT">
				<include name="**/*${module}*.ini" />
			</fileset>
		</copy>

		<copy todir="${target_base_module_dir}/files/site/language/es-ES">
			<fileset dir="${source_site_lang_dir}/es-ES">
				<include name="**/*${module}*.ini" />
			</fileset>
		</copy>

		<copy todir="${target_base_module_dir}/files/site/language/pl-PL">
			<fileset dir="${source_site_lang_dir}/pl-PL">
				<include name="**/*${module}*.ini" />
			</fileset>
		</copy>

		<echo msg="Chmod target dir…" />
		<chmod file="${target_base_dir}" mode="0777" />
	</target>

	<!-- ============================================  -->
	<!-- (DEFAULT)  Target: pack                       -->
	<!-- (Pack and upload component, modules and       -->
	<!-- (overall package)                             -->
	<!-- ============================================  -->
	<target name="pack" depends="build">
		<echo msg="Creating archive…" />

		<echo msg="…module 1…" />
		<zip destfile="${target_base_dir}/${module}.${version}.zip">
			<fileset dir="${target_base_module_dir}/files">
				<include name="**/**" />
			</fileset>
		</zip>

		<echo msg="Files copied and compressed in build directory OK!" />


<!--
		<echo msg="Upload to webserver…" />
		<scp
				host="ssh.strato.de"
				port="21"
				username="www.boldt-webservice.de"
				password="!4816@BoRoMi#StrMP?"
				todir="/webservice3/download/bwpostman">
			<fileset dir="${target_base_dir}">
				<include name="*.zip"/>
				<include name="*.pdf"/>
			</fileset>
		</scp>
		<echo msg="Upload to webserver OK!" />

		<move file="${target_base_dir}/${module}.${version}.zip" tofile="${target_base_module_dir}/${module}.${version}.zip" />
-->
	</target>
</project>
